using Microsoft.VisualStudio.TestTools.UnitTesting;
using kata_pen;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace kata_pen.Tests
{
    [TestClass()]
    public class PencilTests
    {
        [TestMethod()]
        public void writeTest()
        {
            // Test that our text comes back as expected.
            var writer = new Pencil();
            var text = "test run";
            writer.write(text);
            Assert.AreEqual(text, writer.sheet);
        }

        [TestMethod()]
        public void appendTest()
        {
            // Test that our text comes back as expected.
            var writer = new Pencil();
            var text = "She sells sea shells";
            writer.write(text);
            // Test that writing again adds more.
            var text2 = " down by the sea shore";
            writer.write(text2);
            Assert.AreEqual(text + text2, writer.sheet);
        }

        [TestMethod()]
        public void leadDegradationTest()
        {
            // Make a pencil with a durability value
            var writer = new Pencil()
            {
                LeadDurability = 4
            };
            // Test that the capitol letter at the start make it so
            // only "Text" will fit.
            writer.write("Text");
            Assert.AreEqual("Tex", writer.sheet);

            // Make another pencil with a durabiltiy value
            writer = new Pencil()
            {
                LeadDurability = 4
            };
            writer.write("text");
            // Test that all lower case letters will make it so
            // all of "text" will fit.
            Assert.AreEqual("text", writer.sheet);
        }

        [TestMethod()]
        public void sharpenTest()
        {
            // Make a pencil with a durability value
            var writer = new Pencil()
            {
                LeadDurability = 4
            };
            // Test that the capitol letter at the start make it so
            // only "Text" will fit.
            writer.write("Text");
            Assert.AreEqual("Tex", writer.sheet);
            writer.sharpen();
            writer.write("more stuff");
            // should only have taken the space since pencil was 0 length.
            Assert.AreEqual("Tex ", writer.sheet);
            // Lets make room for another sharpen.
            writer.length = 1;
            writer.sharpen();
            writer.write("Mexican");
            // Room for for more character, or three if one is upper case as is here.
            Assert.AreEqual("Tex Mex", writer.sheet);
        }

        [TestMethod()]
        public void eraseTest()
        {
            var writer = new Pencil();
            writer.write("How much wood would a woodchuck chuck if a woodchuck could chuck wood?");
            Assert.AreEqual(writer.sheet, "How much wood would a woodchuck chuck if a woodchuck could chuck wood?");

            // Erase chuck and see if we get what we would expect.
            writer.erase("chuck");
            Assert.AreEqual(writer.sheet, "How much wood would a woodchuck chuck if a woodchuck could       wood?");

            // Erase chuck again and see if we get what we would expect.
            writer.erase("chuck");
            Assert.AreEqual(writer.sheet, "How much wood would a woodchuck chuck if a wood      could       wood?");
        }

        [TestMethod()]
        public void eraseDurabilityTest()
        {
            // Test erasing at end and from right to left
            var writer = new Pencil()
            {
                eraserDurability = 3
            };
            writer.write("Buffalo Bill");
            writer.erase("Bill");
            Assert.AreEqual(writer.sheet, "Buffalo B   ");
        }

        [TestMethod()]
        public void editTest()
        {
            // test erase and edit.
            var writer = new Pencil();
            writer.write("An apple a day keeps the doctor away.");
            writer.erase("apple");
            Assert.AreEqual(writer.sheet, "An       a day keeps the doctor away.");
            writer.edit(3, "onion");
            Assert.AreEqual(writer.sheet, "An onion a day keeps the doctor away.");

            // Now edit in something too big forthe gap.
            writer.erase("onion");
            Assert.AreEqual(writer.sheet, "An       a day keeps the doctor away.");
            writer.edit(3, "artichoke");
            Assert.AreEqual(writer.sheet, "An artich@k@ay keeps the doctor away.");
        }
    }
}